# 인덱싱(Indexing)

인덱싱에 대해서 자세히 알아봅니다.

인덱싱은 데이터베이스 성능 최적화에서 중요한 역할을 합니다. 대용량 데이터를 효율적으로 조회하기 위해
인덱스를 설정하는 방법과 고려사항을 자세히 알아보겠습니다.

## 인덱싱이란?

인덱싱은 데이터베이스의 특정 컬럼에 대해서 빠른 검색을 가능하게 하기 위해 사용하는 데이터 구조입니다.
인덱스는 책의 목차처럼 특정 데이터를 빠르게 찾을 수 있도록 돕습니다. 데이터베이스에서는 주로 B-tree나
Hash와 같은 자료 구조를 사용하여 인덱스를 구현합니다.

## 인덱스를 설정할 때 고려해야 할 기준

- 자주 조회되는 컬럼이 무엇인지
  - WHERE, JOIN, ORDER BY, GROUP BY 절에서 자주 사용되는 컬럼에 인덱스를 설정합니다.
- 고유성
  - 고유한 값을 가지는 컬럼이 인덱스 효율이 높습니다. 예를 들어, 사용자ID, 이메일 주소 등이 있습니다.
- 선택도(Selectivity)
  - 인덱스 컬럼의 값이 고르게 분포되어 있어야 합니다. 특정 값이 전체 데이터의 많은 부분을 차지하면
    인덱스의 효율이 떨어집니다.
- 업데이트 빈도
  - 자주 변경되는 컬럼은 인덱스 유지 비용이 높아지므로 신중하게 선택해야 합니다.

## 단일 컬럼 인덱싱(Single Column Indexing)

단일 컬럼 인덱싱은 하나의 컬럼에 대해서만 인덱스를 설정합니다. 예를 들어, 이메일이 있습니다.

```sql
CREATE INDEX idx_name ON users(name);
```

## 복합 인덱싱 (Composite Indexing)

복합 인덱싱은 두 개 이상의 컬럼을 결합하여 인덱스를 설정합니다. 복합 인덱스는 여러 컬럼을 포함한 검색
조건에서 성능을 향상 시킵니다. 예를 들어, name 과 age 컬럼에 대한 복합 인덱스를 설정할 수 있습니다.

**복합 인덱스는 컬럼의 순서**가 중요합니다. 인덱스는 첫 번째 컬럼에 대한 조건이 있어야만 효율적으로
사용될 수 있습니다.

```sql
CREATE INDEX idx_name_age ON users(name, age);
```

## 컬럼 수가 많지 않은 테이블에 대한 인덱싱의 의미

컬럼 수가 적을 때라도 인덱싱은 유용할 수 있습니다. 특히 자주 조회되는 컬럼에 인덱스를 설정하면 조회 성능
을 크게 향상 시킬 수 있습니다. 하지만, 데이터베이스와 쿼리 패턴에 따라, 인덱스의 필요성과 우선순위가
달라질 수 있습니다.

## 인덱스를 설정할 때 고려해야 할 사항과 노하우

### 인덱스 유지 비용

인덱스는 데이터 삽입, 업데이트, 삭제 시 추가적인 오버헤드가 발생합니다. 인덱스가 많아질 수록 성능에
부정적인 영향을 미칠 수 있으므로 적절한 균형이 필요합니다.

### 쿼리 패턴 분석

쿼리 로그를 분석하여 자주 사용되는 쿼리를 파악하고, 해당 쿼리에 맞는 인덱스를 설정합니다.

### 인덱스 힌트

특정 인덱스를 사용하도록 쿼리에 힌트를 제공하여 데이터베이스 엔진이 최적의 인덱스를 선택하도록 합니다.

### 커버링 인덱스

인덱스가 쿼리의 모든 컬럼을 포함하도록 하여, 쿼리 실행 시 테이블을 읽지 않고 인덱스만으로 결과를 반환
하도록 합니다.

### 인덱스 조정

주기적으로 인덱스를 재조정하거나 재구성하여 인덱스의 효율을 유지합니다. 예를 들어, MySQL에서는
OPTIMIZE TABLE 명령어를 사용할 수가 있습니다.

### 복합 인덱스의 순서

복합 인덱스를 생성할 때 가장 선택도가 높은 컬럼을 첫 번째로 배치합니다. 이는 인덱스의 효율을 높이는데
도움이 됩니다.

### 자동 인덱스 관리 도구

데이터베이스에 따라 자동으로 인덱스를 추천하거나 생성해주는 도구를 사용할 수 있습니다. 예를 들어,
PostgreSQL의 pg_stat_statements을 활용하여 쿼리 성능을 모니터링하고 최적의 인덱스를 찾을 수
있습니다.

---

- 인덱스의 여러 알고리즘 설정. 기본적으로 Btree인데 보통 이걸로 다 되지 않는가. 언제 어떤 상황에서
  알고리즘을 바꾸는 것이 도움이 되는가. 구체적인 예시를 들어라.
- 하나의 테이블에 설정할 수 있는 인덱스의 숫자. 예를 들어 컬럼이 10개인 테이블에 인덱스를 몇 개 까지
  설정하는 것이 좋은가
