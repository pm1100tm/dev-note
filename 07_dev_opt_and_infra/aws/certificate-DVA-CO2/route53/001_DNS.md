# Route53 - DNS

## 🌐 What is DNS (Domain Name System)?

DNS (Domain Name System) 는

- 사람이 기억하기 쉬운 도메인 이름(예: www.google.com)을
  컴퓨터가 이해할 수 있는 IP 주소(예: 172.217.18.36) 로 변환해주는 시스템입니다.

> 즉, DNS는 인터넷의 전화번호부(Phonebook of the Internet) 입니다.

## 🧠 DNS의 역할

| 사람이 입력한 주소 | DNS 변환 결과 |
| ------------------ | ------------- |
| www.google.com     | 172.217.18.36 |

## 🔹 DNS의 계층적 구조 (Hierarchical Naming Structure)

DNS는 트리 구조(Tree Structure) 형태로 구성됩니다.

```shell
Root (.)
 ├── .com
 │    ├── example.com
 │    │    ├── www.example.com
 │    │    └── api.example.com
 ├── .org
 └── .gov
```

- TLD (Top-Level Domain) → .com, .org, .gov, .kr
- SLD (Second-Level Domain) → google.com, amazon.com
- Subdomain → www.example.com, api.example.com

## 📘 DNS 주요 용어 (Terminologies)

| 용어                      | 설명                                      | 예시                              |
| ------------------------- | ----------------------------------------- | --------------------------------- |
| Domain Registrar          | 도메인 등록 기관                          | AWS Route 53, GoDaddy, Namecheap  |
| DNS Record                | 도메인 이름과 IP/리소스 간의 매핑 정보    | A, AAAA, CNAME, MX, NS, TXT       |
| Zone File                 | 도메인에 대한 모든 DNS 레코드를 담은 파일 | example.com zone file             |
| Name Server (NS)          | DNS 요청을 실제로 처리하는 서버           | Authoritative / Non-authoritative |
| TLD (Top-Level Domain)    | 도메인의 최상위 구분자                    | .com, .net, .kr, .org             |
| SLD (Second-Level Domain) | 조직/서비스 이름                          | google.com, amazon.com            |

### 👉 DNS Record

- **A 레코드(Address Record)**
  - 웹서버나 로브벨런서의 IPv4 주소를 등록할 때 사용
  - 도메인 이름을 IPv4 에 연결
  - 브라우저가 example.com 접속할 때, 이 A 레코드가 가리키는 IP 주소로 요청을 보냄

```shell
example.com.   IN   A   123.45.67.89
```

<br>

- **AAAA 레코드(Quad A Record)**
  - IPv6 기반 네트워크 환경을 지원하기 위한 레코드
  - IPv4(A 레코드)와 함께 등록해두면, 클라이언트 환경에 맞게 자동으로 선택됨

```shell
example.com.   IN   AAAA   2001:db8::1
```

<br>

- CNAME 레코드(Canonical Name Record)
  - 하나의 도메인 이름을 다른 도메인 이름에 별칭으로 연결
  - www.example.com 요청을 example.com으로 전달하도록 설정
  - 즉, 실제 IP를 지정하는 대신 다른 도메인 이름을 참조합니다.
  - ⚠️ 주의점
    - 루트 도메인(example.com)에는 CNAME 을 설정할 수 없음
    - 항상 하위 도메인(www, blog, api)에만 사용
    - 서브 도메인을 특정 호스팅 서비스로 연결할 때 사용

```shell
www.example.com. IN CNAME example.com.
```

<br>

- MX 레코드(Mail eXchange Record)
  - 메일 서버 주소를 지정
  - 이메일 전송 시, 어떤 서버가 메일을 수신할지 알려주는 역할
  - 숫자는 우선순위(priority)를 의미하며, 숫자가 낮을수록 먼저 시도
  - 메일 서버 장애 시, 백업 순서로 순차적으로 전달
  - 사용
    - Google Workspace, Naver Works, Microsoft 365, Zoho Mail 등과 연동 시
    - 기업 메일 서비스 세팅

```shell
example.com.   IN   MX   10   mail.example.com.
example.com.   IN   MX   20   backup-mail.example.com.
```

<br>

- TXT 레코드(Text Record)

  - 도메인과 관련된 문자열 정보 저장
  - 인증용, 보안용, 또는 기타 설명용 데이터로 주로 사용
  - 설명:
    - 이메일 스푸핑 방지를 위한 SPF 레코드 또는,
    - Google Search Console / AWS / GitHub / SSL 인증 등의 도메인 소유 검증에 자주 사용
  - 주요 사용 예:
    - SPF, DKIM, DMARC 메일 인증
    - Google, AWS, GitHub 도메인 검증
    - API Key, 서비스 연결 인증

```shell
example.com.   IN   TXT   "v=spf1 include:_spf.google.com ~all"
```

<br>

- NS 레코드(Name Server Record)
  - 도메인 이름을 어떤 네임서버가 관리하는지 지정
  - 설명:
    - 이 NS 레코드가 가리키는 네임서버에서 해당 도메인의 모든 DNS 레코드를 조회할 수 있음
    - 도메인을 처음 등록하면 기본 NS가 자동 설정되지만, Cloud DNS 로 이전 시 변경해야 함
  - 주요 사용 예:
    - Google Cloud DNS, Route53, Cloudflare 등으로 DNS 이전
    - 도메인 레지스트리에서 네임서버 변경 시 필요

```shell
example.com.   IN   NS   ns1.google.com.
example.com.   IN   NS   ns2.google.com.
```

### Record Type 정리표

| Record Type | 설명                         | 예시                                 |
| ----------- | ---------------------------- | ------------------------------------ |
| A           | IPv4 주소 매핑               | example.com → 192.0.2.1              |
| AAAA        | IPv6 주소 매핑               | example.com → 2001:db8::1            |
| CNAME       | 별칭(Alias) 매핑             | www.example.com → example.com        |
| MX          | 메일 서버(Mail Exchanger)    | example.com → mail.google.com        |
| NS          | Name Server 지정             | example.com → ns-123.awsdns-45.org   |
| TXT         | 텍스트 정보 (도메인 인증 등) | v=spf1 include:\_spf.google.com ~all |

### 🙋 외부 도메인을 Google Cloud DNS, Route53 등으로 이전하는 이유

- 도메인 등록기관 (Registrar)
  - 도메인 이름을 구매·소유 관리하는 곳
  - 가비아, Namecheap, GoDaddy, Google Domains
- DNS 호스팅 서비스 (Name Server Provider)
  - 도메인 이름이 어떤 IP로 가야 하는지 기록(DNS Record)을 관리하는 곳
  - AWS Route 53, Google Cloud DNS, Cloudflare

즉, 도메인을 “구매한 곳”과 “DNS를 호스팅하는 곳”은 다를 수 있습니다.
도메인은 가비아에서 사고, DNS 관리는 Route 53에서 할 수도 있습니다.

| 항목                        | Route53 사용시 장점              | Cloud DNS 사용시 장점           |
| --------------------------- | -------------------------------- | ------------------------------- |
| EC2 / ALB / CloudFront 연결 | 자동 레코드 생성 / 헬스체크 통합 | 수동 연결보다 훨씬 간편         |
| SSL 인증서 (ACM, Cloud CA)  | DNS 인증 자동화 지원             | Google Managed SSL 인증 자동화  |
| S서버 이전 / 리전 확장      | DNS 자동 Failover 구성 가능      | Cloud Load Balancer와 통합 지원 |

> 👉 즉, 클라우드 자원과 네이티브하게 연동되므로 운영이 쉬워집니다.

두번째는, 고가용성(HA) + 글로벌 응답 속도에서 장점이 있습니다.

- Route 53이나 Cloud DNS는 전 세계 Anycast 네임서버로 운영됩니다.
  - → 즉, 사용자가 어디서 접속하든 가까운 DNS 서버가 응답합니다.
  - 한국의 가비아, 카페24 같은 Registrar의 네임서버는 국내 중심이라 해외 응답 속도가 느릴 수 있습니다.
  - 🌍 클라우드 DNS는 글로벌 트래픽용으로 설계됨 (지연시간 짧음)

#### 클라우드 DNS로 “이전(또는 위임)”하는 이유

✅ (1) 클라우드 서비스와의 완벽한 통합:

- AWS를 쓰면 → Route 53
- GCP를 쓰면 → Cloud DNS

으로 관리할 경우 다음 장점이 생깁니다:

## ⚙️ How DNS Works (DNS 동작 원리)

- 1. 사용자가 브라우저에 www.example.com 입력
- 2. 브라우저 → 로컬 DNS 캐시 확인
- 3. 없으면 → ISP의 DNS Resolver 로 요청
- 4. Resolver는 순차적으로 질의(Query) 수행
  - • Root DNS Server → .com TLD 위치 확인
  - • TLD Server → example.com의 Name Server 주소 확인
  - • Authoritative Name Server → 실제 IP 주소 응답 (A Record)
- 5. Resolver는 결과(IP 주소)를 브라우저에 반환
- 6. 브라우저가 해당 IP로 접속하여 웹페이지 로드

## 핵심정리

| 항목      | 요약                                       |
| --------- | ------------------------------------------ |
| DNS 역할  | 도메인 → IP 주소로 변환                    |
| 구조      | 루트 → TLD → SLD → Subdomain               |
| 주요 요소 | Registrar, Zone File, Records, Name Server |
| 중요성    | 인터넷 통신의 기반 시스템                  |
| AWS 관련  | Amazon Route 53이 AWS의 DNS 서비스         |
