# ğŸš€ IAM

- ì„¹ì…˜ 4: IAM ë° AWS CLI
  - [12.] IAM ì†Œê°œ: ì‚¬ìš©ì, ê·¸ë£¹, ì •ì±…
  - [13.] IAM ì‚¬ìš©ì ë° ê·¸ë£¹ ì‹¤ìŠµ
  - [14.] IAM ì •ì±…
  - [15.] IAM ì •ì±… ì‹¤ìŠµ
  - [16.] IAM MFA ê°œìš”
  - [17.] IAM MFA ì‹¤ìŠµ
  - [18.] AWS ì—‘ì„¸ìŠ¤ í‚¤, CLI and SDK

---

## IAM Policies inhertence

ì²˜ìŒì— ê²Œì •ì„ ìƒì„±í•˜ê³  ë¡œê·¸ì¸í•˜ê²Œ ë˜ë©´ í•´ë‹¹ ìœ ì €ëŠ” Root ìœ ì €ì…ë‹ˆë‹¤. Root ìœ ì €ëŠ” ëª¨ë“  ê¶Œí•œì„ ê°–ëŠ”
ìŠˆí¼ìœ ì € ì…ë‹ˆë‹¤. ë”°ë¼ì„œ, ì´ Root ê²Œì •ì€ ê°€ê¸‰ì  ì‚¬ìš©í•˜ì§€ ë§ê³ , ëŒ€ë¦¬ ì‚¬ìš©ìë¥¼ ë§Œë“¤ê³  ì‚¬ìš©í•˜ëŠ” ê²ƒì„
ê¶Œì¥í•©ë‹ˆë‹¤. ì´ë ‡ê²Œ ì‚¬ìš©ìë¥¼ ìƒì„±í•˜ê³ , ì‚¬ìš©ìë³„ ê·¸ë£¹ì„ ë§Œë“¤ê³ , ê¶Œí•œì„ ë¶€ì—¬í•˜ëŠ” ê²ƒì´ IAM ì…ë‹ˆë‹¤.

- IAM ì€ ê¸€ë¡œë²Œ ì„œë¹„ìŠ¤ ì…ë‹ˆë‹¤.
- ê·¸ë£¹ê³¼ ê°œë³„ ìœ ì €ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ê° ê·¸ë£¹ë³„ë¡œ ê¶Œí•œì„ ë¶€ì—¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ê° ìœ ì €ë³„ë¡œ ê¶Œí•œì„ ë¶€ì—¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ê·¸ë£¹ì— ì†í•œ ìœ ì €ëŠ”, ê·¸ë£¹ì´ ê°€ì§€ê³  ìˆëŠ” ê¶Œí•œì„ ìƒì†ë°›ìŠµë‹ˆë‹¤.
- ìœ ì €ëŠ” ë³µìˆ˜ì˜ ê·¸ë£¹ì— ì†í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ìœ ì €ëŠ” ê·¸ë£¹ì— ì†í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## IAM Permission

ìœ ì € ë˜ëŠ” ê·¸ë£¹ì— ëŒ€í•´ì„œ Json Document í˜•íƒœì˜ ì •ì±…ì„ ì§€ì •í•©ë‹ˆë‹¤.

ğŸ“Œ IAM Policy JSON êµ¬ì¡° ì„¤ëª…

```json
{
  "Version": "2012-10-17",
  "Id": "TODO",
  "Statement": [
    {
      "Sid": "1",
      "Effect": "Allow",
      "Action": "ec2:Describe*",
      "Resource": "*"
    },
    {
      "Sid": "2",
      "Effect": "Allow",
      "Action": "elasticloadbalancing:Describe*",
      "Resource": "*"
    },
    {
      "Sid": "3",
      "Effect": "Allow",
      "Action": [
        "cloudwatch:ListMetrics",
        "cloudwatch:GetMetricStatistics",
        "cloudwatch:Describe*"
      ],
      "Resource": "*"
    }
  ]
}
```

### 1. Version

- ì •ì±… ì–¸ì–´ ë²„ì „ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.
- AWSê°€ ì •ì±… JSON ìŠ¤í‚¤ë§ˆë¥¼ ì—…ë°ì´íŠ¸í•œ ë‚ ì§œë¥¼ ë‚˜íƒ€ë‚´ë©°, í˜„ì¬ëŠ” "2012-10-17"ì´ ìµœì‹  ë²„ì „ì´ì
  í‘œì¤€ìœ¼ë¡œ í•­ìƒ ì‚¬ìš©ë©ë‹ˆë‹¤.
- Id: ì •ì±…ì˜ ì‹ë³„ì (optional)

### 2. Statement

- ì •ì±…ì˜ ì‹¤ì œ ê¶Œí•œ ê·œì¹™ ë¸”ë¡ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.
- ë°°ì—´ í˜•íƒœë¡œ ë˜ì–´ ìˆì–´, ì—¬ëŸ¬ ê°œì˜ ê·œì¹™ì„ ë¬¶ì–´ì„œ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ê°ê°ì˜ ìš”ì†Œê°€ í•˜ë‚˜ì˜ ê·œì¹™(Statement)ì…ë‹ˆë‹¤.
- Sid: statement ì˜ ì‹ë³„ì (optional)

### 3. Statements consists of

### 3-0. Principal

- ì–´ë–¤ ê¶Œí•œì„ ê³„ì •/ìœ ì €/ë¡¤ ì—ê²Œ ì ìš©í• ì§€ ê²°ì¡í•©ë‹ˆë‹¤.

### 3-1. Effect

- "Allow" ë˜ëŠ” "Deny" ê°’ì„ ê°€ì§‘ë‹ˆë‹¤.
- ê¶Œí•œì„ í—ˆìš©(Allow) í• ì§€, ê±°ë¶€(Deny) í• ì§€ ì§€ì •í•©ë‹ˆë‹¤.

### 3-2. Action

- í—ˆìš©í•˜ê±°ë‚˜ ê±°ë¶€í•  AWS API ë™ì‘(ì„œë¹„ìŠ¤ë³„ ì•¡ì…˜) ì„ ì§€ì •í•©ë‹ˆë‹¤.
- ì˜ˆì‹œ:
  - "ec2:Describe\*" â†’ EC2ì˜ Describeë¡œ ì‹œì‘í•˜ëŠ” ëª¨ë“  API í˜¸ì¶œ í—ˆìš©
  - "elasticloadbalancing:Describe\*" â†’ ELBì˜ Describe ê´€ë ¨ API í—ˆìš©
  - "cloudwatch:ListMetrics",
    "cloudwatch:GetMetricStatistics",
    "cloudwatch:Describe\*" â†’ CloudWatchì—ì„œ íŠ¹ì • ë©”íŠ¸ë¦­ ì¡°íšŒ ë° í†µê³„ ì¡°íšŒ í—ˆìš©

ğŸ‘‰ "\*" (ì™€ì¼ë“œì¹´ë“œ) ì‚¬ìš© ê°€ëŠ¥

- ec2:\* â†’ EC2ì˜ ëª¨ë“  API
- ec2:Describe\_ â†’ Describeë¡œ ì‹œì‘í•˜ëŠ” ëª¨ë“  EC2 API 5. Resource

### 3-3. Resource

- ê¶Œí•œì´ ì ìš©ë˜ëŠ” ëŒ€ìƒ ë¦¬ì†ŒìŠ¤ë¥¼ ì§€ì •í•©ë‹ˆë‹¤.
- "\*" â†’ ëª¨ë“  ë¦¬ì†ŒìŠ¤ì— ëŒ€í•´ ê¶Œí•œ í—ˆìš©
- ì˜ˆì‹œ:
  - íŠ¹ì • EC2 ì¸ìŠ¤í„´ìŠ¤ì—ë§Œ í—ˆìš©í•˜ë ¤ë©´ "arn:aws:ec2:ap-northeast-2:123456789012:instance/i-0abcd1234efgh5678"
    ê°™ì´ ARN(ë¦¬ì†ŒìŠ¤ ì‹ë³„ì) ë¥¼ ë„£ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## 3-4. Condition (Optional)

- ê¶Œí•œì´ ì–¸ì œ ì ìš©ë ì§€ ê²°ì •

---

## ì ìš©í•œ ê¶Œí•œì˜ ì •ì±… Json ê°’ í™•ì¸í•˜ê¸°

IAM -> Policies -> íŠ¹ì • ê¶Œí•œ(ì •ì±…) í´ë¦­ -> Json

![IAM Permission Check](./assets/iam_permission_json_check_1.png)
![IAM Permission Check](./assets/iam_permission_json_check_2.png)

## ì •ì±… í¸ì§‘ê¸° - ì»¤ìŠ¤í„°ë§ˆì´ì§•

IAM -> Policies -> Create policy -> Visual or Json

![IAM Permission custom](./assets/iam_permission_custom_1.png)
![IAM Permission custom](./assets/iam_permission_custom_2.png)

---

## MFA(Multi Factor Authentication)

MFA ë€ ë¡œê·¸ì¸ ì‹œ Password ì¸ì¦ ë°©ì‹ì—ì„œ, ìì‹ ì´ ì†Œìœ í•œ ê¸°ê¸° ì¸ì¦ ë°©ì‹ì„ ì¶”ê°€í•œ ê²ƒìœ¼ë¡œ,
ë¹„ë°€ë²ˆí˜¸ íƒˆì·¨ì™€ í•´í‚¹ì—ì„œ í•œ ë‹¨ê³„ ë³´í˜¸ ì¥ì¹˜ë¥¼ ì¶”ê°€í•œ ê²ƒì…ë‹ˆë‹¤.

AWS ì—ì„œ ì§€ì›í•˜ëŠ” MFA ì¥ì¹˜

- ê°€ìƒ ë””ë°”ì´ìŠ¤

  - Google Authenticator (phone only)
  - Authy (phone only)

- ë¬¼ë¦¬ ë””ë°”ì´ìŠ¤

  - U2F: Universal 2nd Factor Security Key (USB ê°™ì€ ê²ƒ)

- í•˜ë“œì›¨ì–´ í‚¤
  - Gemalto (3rd party)
  - AWS GovCloud(US) - SurePassId (3rd party)

### MFA ë“±ë¡í•˜ëŠ” ë°©ë²•

AWS Console -> ì˜¤ë¥¸ìª½ ìƒë‹¨ ê³„ì • í´ë¦­ -> Security credentials í´ë¦­

Multi-factor authentication ì„¹ì…˜ ìš°ì¸¡ Assign MFA device ì—ì„œ ë“±ë¡

---

## ë¹„ë°€ë²ˆí˜¸ ê·œì¹™ ì»¤ìŠ¤í„°ë§ˆì´ì§•

IAM -> account setting -> edit -> Password policy ì—ì„œ custom ì„ íƒ í›„ ë£° ì„¤ì •

![IAM password rule custom](./assets/iam_password_rule_custom_1.png)
![IAM password rule custom](./assets/iam_password_rule_custom_2.png)

## ğŸ’° IAM ì—ì„œ ê·¸ë£¹ì´ë‚˜ ìœ ì €ë¥¼ ìƒì„±í•˜ê³  ìœ ì§€í•˜ë©´ ë¹„ìš©ì´ ë°œìƒí• ê¹Œ?

IAM(User, Group, Role, Policy) ìì²´ë¥¼ ìƒì„±í•˜ê±°ë‚˜ ê´€ë¦¬í•˜ëŠ” ë°ì—ëŠ” ë³„ë„ì˜ ë¹„ìš©ì´ ë°œìƒí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
IAM ì€ ë¬´ë£Œ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.

í•˜ì§€ë§Œ,

- IAMìœ¼ë¡œ ë§Œë“  ìœ ì €/ì—­í• ì´ ì‹¤ì œë¡œ ë¦¬ì†ŒìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©´, ê·¸ ì‚¬ìš©í•œ ë¦¬ì†ŒìŠ¤ì— ëŒ€í•´ì„œëŠ” ì •ìƒì ìœ¼ë¡œ ê³¼ê¸ˆë©ë‹ˆë‹¤.
  ì˜ˆ: IAM ìœ ì €ê°€ EC2 ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‹¤í–‰í•˜ë©´ â†’ EC2 ìš”ê¸ˆ ë°œìƒ
- IAM ìœ ì €ê°€ S3ì— ë°ì´í„°ë¥¼ ì˜¬ë¦¬ë©´ â†’ S3 ìŠ¤í† ë¦¬ì§€ ë° ì „ì†¡ ìš”ê¸ˆ ë°œìƒ
- IAM ê´€ë ¨ ë³´ì•ˆ ê¸°ëŠ¥ ì¤‘ ì¼ë¶€ëŠ” ë³„ë„ ê³¼ê¸ˆì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  - IAM Access Analyzer â†’ ê¸°ë³¸ ê¸°ëŠ¥ì€ ë¬´ë£Œ, ê³ ê¸‰ ë¶„ì„ ê¸°ëŠ¥ì€ AWS Organizations ë‹¨ìœ„ì—ì„œ
    ì¶”ê°€ ë¹„ìš© ë°œìƒ ê°€ëŠ¥
  - AWS CloudTrail (IAM í™œë™ ë¡œê¹…) â†’ ê´€ë¦¬ ì´ë²¤íŠ¸ ê¸°ë³¸ 90ì¼ ë¬´ë£Œ ì €ì¥, í•˜ì§€ë§Œ ë°ì´í„° ì´ë²¤íŠ¸/ì¥ê¸°
    ë³´ê´€ì€ ë¹„ìš© ë°œìƒ

ğŸ“Œ ê²°ë¡ 

- IAM User/Group/Role/Policy ìƒì„±/ì‚¬ìš© â†’ ë¬´ë£Œ
- IAM ìœ ì €/ì—­í• ì´ ì‚¬ìš©í•˜ëŠ” AWS ë¦¬ì†ŒìŠ¤ ë¹„ìš©ë§Œ ê³¼ê¸ˆ
- ì¼ë¶€ ë³´ì•ˆ/ë¡œê¹… ì„œë¹„ìŠ¤ëŠ” ë³„ë„ ìš”ê¸ˆì´ ë¶™ì„ ìˆ˜ ìˆìŒ

---

## 1. How can users access to AWS?

- AWS Manage console
  - password ì™€ MFA ë¡œ ë³´í˜¸ë¨
- AWS Command Line Interface(CLI)
  - access key ë¡œ ë³´í˜¸ë¨
- AWS Software Development Kit(SDK)
  - ì½”ë“œì—ì„œ ì ‘ê·¼, access key ë¡œ ë³´í˜¸ë¨

## 2. Access Key ëŠ” ì–´ë–»ê²Œ ìƒì„±í•˜ëŠ”ê°€?

- Access Key: ì‚¬ìš©ì ID ê°œë…
- Secret Key: ì‚¬ìš©ì Password ê°œë…

IAM -> Users -> íŠ¹ì • ìœ ì € ì„ íƒ -> Security credentials íƒ­ -> Access kyes ì„¹ì…˜
-> Create access key

![Access Key](./assets/access_key_1.png)
![Access Key](./assets/access_key_2.png)
![Access Key](./assets/access_key_3.png)

## 3. SDK ë€ ë¬´ì—‡ì¸ê°€?

- AWS ì†Œí”„íŠ¸ì›¨ì–´ ê°œë°œ í‚¤íŠ¸ (AWS SDK)
- ì–¸ì–´ë³„ API(ë¼ì´ë¸ŒëŸ¬ë¦¬ ì§‘í•©)
- AWS ì„œë¹„ìŠ¤ë¥¼ í”„ë¡œê·¸ë˜ë° ë°©ì‹ìœ¼ë¡œ ì•¡ì„¸ìŠ¤í•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆë„ë¡ ì§€ì›
- ì• í”Œë¦¬ì¼€ì´ì…˜ì— ë‚´ì¥ë˜ì–´ ë™ì‘
- ì§€ì› í•­ëª©
  - SDKs: JavaScript, Java, Python, PHP, .NET, Ruby, Go, Node.js, C++
  - ëª¨ë°”ì¼ SDKs: Android, iOS ë“±
  - IoT ë””ë°”ì´ìŠ¤ SDKs: Embedded C, Arduino ë“±
- ì˜ˆì‹œ:
  - AWS CLIëŠ” Pytho nìš© AWS SDKë¥¼ ê¸°ë°˜ìœ¼ë¡œ êµ¬ì¶•ë¨

## 4. AWS CLI ì„¤ì¹˜í•˜ê³  ì‚¬ìš©í•´ë³´ê¸°

MAC ì„ ì‚¬ìš©í•œë‹¤ê³  ê°€ì •í•˜ê³  AWS CLI ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.

```shell
â•­â”€ ï…¹  ï¼ ~/â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€î‚² âœ”
â•°â”€ brew install awscli

â•­â”€ ï…¹  ï¼ ~/â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€î‚² âœ”
â•°â”€ aws --version

â•­â”€ ï…¹  ï¼ ~/â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€î‚² âœ”
â•°â”€ aws configure
AWS Access Key ID [****************YZ6H]: <ì…ë ¥>
AWS Secret Access Key [****************V3tJ]: <ì…ë ¥>
Default region name [ap-northeast-2]: <ìì‹ ì˜ ë¦¬ì „ ì…ë ¥>
Default output format [json]: <ì…ë ¥>

â•­â”€ ï…¹  ï¼ ~/â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€î‚² âœ”
â•°â”€ aws iam list-users
{
    "Users": [
        {
            "Path": "/",
            "UserName": "a****",
            "UserId": "A************************8",
            "Arn": "arn:aws:iam::992382428865:user/admin",
            "CreateDate": "2025-03-03T03:42:22+00:00",
            "PasswordLastUsed": "2025-09-11T01:03:04+00:00"
        },
        {
            "Path": "/",
            "UserName": "d****",
            "UserId": "A************************8",
            "Arn": "arn:aws:iam::992382428865:user/dev-swd",
            "CreateDate": "2025-09-11T02:01:47+00:00"
        }
    ]
}
```

## CloudShell

![cloud shell](./assets/cloud_shell.png)
